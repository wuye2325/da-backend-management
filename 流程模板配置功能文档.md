# 流程模板配置功能文档

## 功能概述

流程模板配置是系统核心功能之一，用于创建和管理各类业务流程模板。管理员可以通过可视化界面配置流程步骤、设置审批规则、定义权限范围，为小区各类事务提供标准化的处理流程。

## 页面布局设计

### 主要区域划分

1. **顶部导航区域**
   - 申请记录、模板设置、规则设置三个标签页
   - 支持标签页间的快速切换

2. **申请记录标签页**（当前页面为申请记录时）
   - 顶部筛选条件区域
   - 中部数据列表区域
   - 底部分页导航区域

3. **模板设置标签页**（当前页面为模板设置时）
   - 左侧配置面板：基本信息配置、流程步骤设置、权限配置选项
   - 右侧预览区域：流程图可视化展示、实时预览配置效果

4. **规则设置标签页**（当前页面为规则设置时）
   - 规则配置面板
   - 规则预览区域

## 功能模块详细说明

### 1. 申请记录标签页功能

#### 显示内容维度

**1. 筛选条件区域**
- **提交时间**：支持日期范围选择（开始时间-结束时间）
- **完成时间**：支持日期范围选择，可选择具体日期
- **审批状态**：下拉选择（全部、进行中、已完成、已拒绝、已撤回等）
- **部门筛选**：下拉选择部门，支持"请选择"默认选项
- **申请人**：文本输入框，支持姓名或员工号搜索
- **审批编号**：文本输入框，支持精确或模糊搜索
- **报销类型**：下拉选择（全部、差旅费、办公用品、其他等）
- **金额范围**：双输入框（最小金额-最大金额），单位为元

**2. 数据列表区域**
- **动态表头**：根据具体流程配置自动生成列标题
  - 基础列：审批编号、提交时间、完成时间、申请人姓名、报销类型、金额(元)、附件、审批状态、操作
  - 扩展列：根据流程模板配置的自定义字段动态添加
- **数据展示**：
  - 审批编号：唯一标识，支持点击查看详情
  - 时间字段：格式化显示（YYYY/MM/DD）
  - 金额字段：数字格式化，保留两位小数
  - 状态字段：彩色标签显示（进行中-蓝色、已完成-绿色、已拒绝-红色）
  - 附件字段：显示附件数量或下载链接
- **数据统计**：页面顶部显示"共X条申请记录"
- **空状态处理**：无数据时显示"无申请记录"提示

**3. 分页导航区域**
- **分页控件**：支持页码跳转和每页显示数量选择
- **数据加载**：支持异步加载和加载状态提示

#### 操作维度

**1. 查询操作**
- **筛选查询**：根据筛选条件实时查询数据
- **重置筛选**：一键清空所有筛选条件
- **高级搜索**：支持多条件组合查询

**2. 数据操作**
- **查看详情**：点击审批编号或操作列的"查看"按钮
- **导出记录**：支持导出当前筛选结果为Excel文件
- **批量操作**：支持批量选择和批量导出

**3. 列表操作**
- **排序功能**：支持按时间、金额等字段排序
- **列显示控制**：支持自定义显示/隐藏列
- **刷新数据**：手动刷新当前页面数据

**4. 权限控制操作**
- **查看权限**：根据用户角色控制可查看的申请记录范围
- **操作权限**：根据流程配置控制用户可执行的操作
- **数据脱敏**：敏感信息根据权限进行脱敏显示

### 2. 模块设置标签页功能

#### 显示内容维度

**1. 页面布局结构**
- **左侧表单设计区域**：可视化表单预览和编辑区域
- **右侧组件库面板**：提供各类表单组件供拖拽使用
- **顶部工具栏**：模板基本信息配置和操作按钮
- **底部组件添加区**：快速添加常用组件的入口

**2. 表单设计区域**
- **表单预览**：实时显示表单的最终效果
- **组件容器**：支持拖拽排序的组件容器
- **字段配置**：点击组件可配置字段属性
- **布局网格**：提供网格辅助线帮助对齐

**3. 组件库面板**
- **基础组件**：
  - 文本：单行文本输入框
  - 多行文本：多行文本输入区域
  - 数字：数字输入框，支持格式验证
  - 金额：金额输入框，自动格式化
- **选择组件**：
  - 单选框：单项选择组件
  - 多选框：多项选择组件
  - 下拉选择：下拉菜单选择
  - 部门选择：组织架构选择器
- **时间组件**：
  - 日期：日期选择器
  - 日期+时间：日期时间选择器
  - 时长：时间长度输入
- **高级组件**：
  - 附件：文件上传组件
  - 位置：地理位置选择
  - 关联申请单：关联其他申请的组件
  - 明细：表格明细录入
- **特殊组件**：
  - 说明文字：纯文本说明
  - 手机号：手机号码输入
  - 收款账户：银行账户信息

#### 操作维度

**1. 模板基础配置**
- **模板信息设置**：
  - 模板名称：必填项，支持中文输入，最多50字符
  - 模板描述：选填项，详细说明模板用途和适用场景
  - 模板分类：下拉选择（报销、报修、投诉、建议等）
  - 打印格式：支持默认格式和自定义格式

**2. 组件拖拽操作**
- **添加组件**：从右侧组件库拖拽到左侧表单区域
- **移动组件**：在表单内拖拽调整组件位置
- **删除组件**：选中组件后删除或拖拽到垃圾桶
- **复制组件**：快速复制现有组件配置

**3. 组件属性配置**
- **基本属性**：
  - 字段名称：组件显示标签
  - 字段标识：系统内部字段名
  - 是否必填：设置字段必填验证
  - 默认值：预设字段默认值
- **高级属性**：
  - 字段提示：输入提示文字
  - 验证规则：数据格式验证
  - 显示条件：条件显示逻辑
  - 计算公式：字段间计算关系

**4. 表单布局操作**
- **布局调整**：调整组件宽度和排列方式
- **分组管理**：将相关字段分组显示
- **页面分割**：支持多页表单设计
- **响应式布局**：适配不同屏幕尺寸

**5. 预览和测试**
- **实时预览**：左侧实时显示表单效果
- **移动端预览**：查看移动端显示效果
- **表单测试**：模拟填写和提交流程
- **数据验证**：测试字段验证规则



### 3. 规则设置标签页功能

#### 显示内容维度

**1. 页面布局结构**
- **左侧规则配置区域**：各类规则配置选项的表单区域
- **右侧流程预览区域**：显示当前规则配置下的流程示意图
- **顶部操作工具栏**：保存、重置、预览等操作按钮
- **底部状态栏**：显示配置状态和提示信息

**2. 规则配置区域**
- **可见范围设置**：
  - 流程模板选择：下拉选择框，选择适用的流程模板
  - 模板发布后通知：复选框，控制模板发布后是否通知相关人员
- **申请流程设置**：
  - 流程步骤配置：可视化流程图编辑器
  - 步骤节点设置：每个节点的处理人、时限、规则配置
  - 流程分支设置：条件分支和并行分支的配置
- **异常处理设置**：
  - 审批人节点异常处理方式：单选按钮组
    - 自动同意（默认选中）
    - 转交给指定人员处理
  - 成员离职时处理方式：单选按钮组
    - 提醒管理员手动交接（默认选中）
    - 自动交接给指定人员
  - 办理人节点异常处理方式：单选按钮组
    - 自动同意（默认选中）
    - 转交给指定人员处理
  - 成员离职时处理方式：单选按钮组
    - 提醒管理员手动交接（默认选中）
    - 自动交接给指定人员

**3. 权限控制配置**
- **自动审批设置**：
  - 审批规则选择：单选按钮组
    - 仅首个节点需审批，其余自动同意（默认选中）
    - 仅连续审批时自动同意
    - 每个节点都需要审批
- **提交权限设置**：
  - 允许代他人提交申请：复选框，控制是否允许代理提交
- **查看权限设置**：
  - 查看范围控制：复选框，"仅管理员、申请人、审批人、抄送人和举报中被@的成员可查看申请详情"
- **修改权限设置**：
  - 提交申请时修改限制：复选框，"提交申请时，员工不可修改固定审批人"（默认选中）
  - 审批过程中修改限制：复选框，"提交申请时，员工不可删除固定抄送人"（默认选中）
  - 完成后修改限制：复选框，"提交申请时，员工不可修改固定办理人"（默认选中）
- **撤销权限设置**：
  - 通过后允许撤销：复选框，"申请通过后，经审批人和办理人同意可撤销申请"
- **加签权限设置**：
  - 允许在审批单中增加临时审批人：复选框，控制动态加签功能（默认选中）

**4. 意见和签名配置**
- **审批意见设置**：
  - 审批人同意或驳回单据时必须填写审批意见：复选框，控制审批意见必填
- **办理意见设置**：
  - 办理人提交办理结果时必须填写办理意见：复选框，控制办理意见必填
- **电子签名设置**：
  - 审批人同意时需要签名：复选框，控制电子签名功能

**5. 协助管理配置**
- **协助管理设置**：设置按钮，点击进入协助管理详细配置页面

#### 操作维度

**1. 基础配置操作**
- **模板选择**：从下拉列表中选择要配置规则的流程模板
- **规则启用/停用**：通过复选框控制各项规则的启用状态
- **选项切换**：通过单选按钮在不同规则选项间切换

**2. 高级配置操作**
- **流程图编辑**：在右侧预览区域直接编辑流程节点和连线
- **节点属性设置**：点击流程节点设置处理人、时限等属性
- **条件分支配置**：设置流程分支的触发条件和路径

**3. 权限管理操作**
- **权限范围设置**：精确控制不同角色的操作权限范围
- **异常处理配置**：设置各种异常情况下的自动处理规则
- **通知规则配置**：设置各环节的通知时机和方式

**4. 配置管理操作**
- **保存配置**：保存当前所有规则配置
- **重置配置**：恢复到默认配置状态
- **预览效果**：预览当前配置下的流程执行效果
- **配置验证**：检查配置的完整性和合理性

**5. 批量操作**
- **批量启用**：批量启用多个规则选项
- **批量停用**：批量停用多个规则选项
- **配置复制**：将当前配置复制到其他流程模板
- **配置导入导出**：支持规则配置的导入和导出

## 操作流程

### 创建新模板
1. 点击"新建模板"按钮
2. 在模块设置标签页配置表单字段和组件
3. 在规则设置标签页配置审批规则和权限
4. 预览配置效果
5. 保存模板配置

### 编辑现有模板
1. 从申请记录标签页选择要编辑的模板
2. 在模块设置标签页修改表单配置
3. 在规则设置标签页调整规则配置
4. 预览修改效果
5. 保存更新

### 查看申请记录
1. 在申请记录标签页设置筛选条件
2. 查看申请记录列表
3. 点击记录查看详情
4. 导出需要的记录数据

## 总结

流程模板配置功能通过三个核心标签页，为管理员提供了完整的流程管理解决方案：

1. **申请记录**：提供申请数据的查询、查看和管理功能
2. **模块设置**：通过拖拽式表单设计器配置申请表单
3. **规则设置**：配置详细的审批规则、权限控制和流程规则

该功能具有配置灵活、界面直观、权限完善、易于使用的特点，能够满足小区管理的各类流程配置需求。