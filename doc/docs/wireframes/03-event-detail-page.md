# 事件详情页 线框图设计

## 📱 页面概述

事件详情页是用户深入了解具体事件的核心页面，提供完整的事件信息、AI智能分析和互动功能。

### 🎯 设计目标
- 提供事件的完整信息展示
- 突出AI智能分析功能
- 优化时间线和进展展示
- 增强用户互动体验
- 支持业委会的管理操作

## 🏗️ 页面结构

```
┌─────────────────────────────────────┐
│ 顶部导航栏 (TopNavigation)            │
├─────────────────────────────────────┤
│ 事件基本信息                          │
├─────────────────────────────────────┤
│ AI速览卡片 (新增核心功能)              │
├─────────────────────────────────────┤
│ 操作按钮区                          │
│ [订阅] [分享]                        │
├─────────────────────────────────────┤
│ 时间线筛选器                         │
│ [全部] [公告] [征询] [审批] [进展]    │
├─────────────────────────────────────┤
│ 结构化时间线                         │
│ ┌─────────────────────────────────┐ │
│ │ 时间线项目 1                    │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ 时间线项目 2                    │ │
│ └─────────────────────────────────┘ │
├─────────────────────────────────────┤
│ 业委会操作区 (角色相关)              │
│ [新增进展] [关联流程] [协同编辑]      │
└─────────────────────────────────────┘
```

## 🧩 组件详细设计

### 1. 顶部导航栏 (TopNavigation)
**复用现有组件，增加功能**

```
┌─────────────────────────────────────┐
│ [←] 36梯停车棚改造项目        [⋯] │
└─────────────────────────────────────┘
```

**功能说明：**
- 左侧返回按钮
- 显示事件标题（截断显示）
- 右侧更多操作菜单（编辑、删除、置顶等）
- **协同编辑**：邀请其他业委会成员协同编辑

### 2. AI速览卡片 (核心新增功能)
**全新组件设计**

```
┌─────────────────────────────────────┐
│ 🤖 AI速览                    [展开] │
├─────────────────────────────────────┤
│ 📊 事件概要                         │
│ 停车棚改造项目，涉及36梯架空层改造... │
├─────────────────────────────────────┤
│ 👥 关键参与方                       │
│ • 业委会：张三(主任)、李四           │
│ • 物业：王五(工程部)                │
│ • 业主：赵六等12户                  │
├─────────────────────────────────────┤
│ ⏰ 重要时间节点                     │
│ • 2024-01-10：业主大会讨论          │
│ • 2024-01-15：方案公示              │
│ • 2024-01-20：开始施工(预计)        │
├─────────────────────────────────────┤
│ 📈 当前状态：审批中 | 影响范围：36梯  │
│ 💰 预算：15万元 | 🏗️ 工期：2个月     │
└─────────────────────────────────────┘
```

**展开状态设计：**
```
┌─────────────────────────────────────┐
│ 🤖 AI速览                    [收起] │
├─────────────────────────────────────┤
│ 📊 事件概要                         │
│ 停车棚改造项目，涉及36梯架空层改造... │
├─────────────────────────────────────┤
│ 👥 关键参与方                       │
│ • 业委会：张三(主任)、李四           │
│ • 物业：王五(工程部)                │
│ • 业主：赵六等12户                  │
├─────────────────────────────────────┤
│ ⏰ 重要时间节点                     │
│ • 2024-01-10：业主大会讨论          │
│ • 2024-01-15：方案公示              │
│ • 2024-01-20：开始施工(预计)        │
├─────────────────────────────────────┤
│ 📋 合约信息                         │
│ • 施工单位：XX建筑公司              │
│ • 合同金额：15万元                  │
│ • 质保期：2年                       │
├─────────────────────────────────────┤
│ 💰 费用明细                         │
│ • 材料费：10万元                    │
│ • 人工费：4万元                     │
│ • 管理费：1万元                     │
├─────────────────────────────────────┤
│ 📈 当前状态：审批中 | 影响范围：36梯  │
│ 🎯 完成度：60% | ⚠️ 风险：天气影响   │
├─────────────────────────────────────┤
│ [AI重新分析] [编辑概要] [导出报告]   │
└─────────────────────────────────────┘
```

**功能说明：**
- AI智能生成事件概要和关键信息
- 支持展开/收起切换
- 显示关键参与方、时间节点、状态信息
- 展开后显示更详细的合约、费用信息
- 支持AI重新分析和手动编辑
- 业委会可导出AI分析报告

**技术实现：**
- 组件名：`AIEventOverview`
- 位置：`src/components/AIEventOverview.tsx`
- 状态管理：展开/收起状态
- 数据：静态模拟AI分析结果

### 3. 事件基本信息
**优化现有组件**

```
┌─────────────────────────────────────┐
│ 36梯停车棚改造项目                     │
├─────────────────────────────────────┤
│ 👤 [头像] 张三 [业委会主任]          │
│ 📅 事件时间：2024-01-10             │
│ 🔄 更新时间：2024-01-15 14:30       │
│ 📊 状态：进行中                     │
├─────────────────────────────────────┤
│ 经过业主大会充分讨论，决定将36梯架空层│
│ 外空地改造成非机动车停车棚，以解决... │
├─────────────────────────────────────┤
│ #停车改造 #业主大会 #基础设施         │
└─────────────────────────────────────┘
│ 👁️ 156人浏览 | 💬 23条评论 | 👍 45赞 │
│ 📖 已读：89人 | 未读：67人          │
├─────────────────────────────────────┤
```

**功能说明：**
- 显示发布者头像、姓名和角色标签
- 事件时间和最后更新时间
- 事件状态（进行中、已搁置、已完成）
- 互动数据统计
- 已读/未读人数统计（点击可查看列表）
- 富文本内容展示
- 相关标签展示

### 4. 操作按钮区
**优化现有功能**

```
┌─────────────────────────────────────┐
│ [🔔 订阅] [📤 分享]                   │
└─────────────────────────────────────┘
```

**功能说明：**
- **订阅按钮**：订阅后接收事件更新通知
- **分享按钮**：支持微信原生卡片分享


### 5. 时间线筛选器
**新增组件设计**

```
┌─────────────────────────────────────┐
│ [全部] [公告] [征询] [审批] [进展]    │
│ 排序：[⬇️ 最新] [⬆️ 最早]            │
└─────────────────────────────────────┘
```

**功能说明：**
- 按流程类型筛选时间线项目
- 支持时间排序切换（正序、倒序）
- 选中状态用不同颜色标识
- 显示每种类型的数量（可选）

**技术实现：**
- 组件名：`TimelineFilter`
- 位置：`src/components/TimelineFilter.tsx`

### 6. 结构化时间线
**重点优化组件**

#### 6.1 时间线整体设计
```
┌─────────────────────────────────────┐
│ 📅 2024-01-15 14:30                │
│ ├─ 📢 [业委会公告] 施工方案公示       │
│ │   张三发布了详细的施工方案...       │
│ │   📎 施工图纸.pdf | 👁️ 45人浏览    │
│ │   [查看详情] [下载附件]            │
│ │   [👍 18] [👎 2] [👥 8] [➖ 1]      │
├─────────────────────────────────────┤
│ 📅 2024-01-12 09:00                │
│ ├─ 🗳️ [征询意见] 停车棚设计方案      │
│ │   收集业主对设计方案的意见建议...   │
│ │   👍 32票赞成 | 👎 3票反对         │
│ │   [参与投票] [查看结果]            │
│ │   [👍 32] [👎 3] [👥 15] [➖ 2]     │
├─────────────────────────────────────┤
│ 📅 2024-01-10 19:30                │
│ ├─ 📋 [业主大会] 停车棚改造讨论       │
│ │   业主大会讨论36梯停车棚改造事宜... │
│ │   📊 出席：45户 | 赞成：42户       │
│ │   [查看会议纪要]                   │
│ │   [👍 42] [👎 1] [👥 2] [➖ 0]      │
└─────────────────────────────────────┘
```

#### 6.2 不同类型时间线项目设计

**公告类型**
```
┌─────────────────────────────────────┐
│ 📅 2024-01-15 14:30                │
│ ├─ 📢 [业委会公告] 施工方案公示       │
│ │   👤 张三(业委会主任)              │
│ │   📝 发布了详细的施工方案和时间安排 │
│ │   📎 施工图纸.pdf (2.3MB)         │
│ │   👁️ 45人浏览 | 💬 8条评论         │
│ │   [查看详情] [下载附件] [评论]     │
│ │   [👍 18] [👎 2] [👥 8] [➖ 1]      │
└─────────────────────────────────────┘
```

**征询意见类型**
```
┌─────────────────────────────────────┐
│ 📅 2024-01-12 09:00                │
│ ├─ 🗳️ [征询意见] 停车棚设计方案      │
│ │   👤 李四(业委会成员)              │
│ │   📝 收集业主对设计方案的意见建议   │
│ │   📊 投票进度：35/120户参与        │
│ │   👍 32票赞成 | 👎 3票反对         │
│ │   ⏰ 截止时间：2024-01-20          │
│ │   [参与投票] [查看详情] [统计结果] │
│ │   [👍 32] [👎 3] [👥 15] [➖ 2]     │
└─────────────────────────────────────┘
```

**审批类型**
```
┌─────────────────────────────────────┐
│ 📅 2024-01-08 16:20                │
│ ├─ 📋 [用印申请] 施工合同盖章         │
│ │   👤 王五(业委会成员)              │
│ │   📝 申请为施工合同加盖业委会公章   │
│ │   📊 审批状态：已通过              │
│ │   ✅ 张三(主任)已同意              │
│ │   ✅ 李四已同意 | ✅ 赵六已同意     │
│ │   [查看申请] [审批详情]            │
│ │   [👍 25] [👎 1] [👥 5] [➖ 0]      │
└─────────────────────────────────────┘
```

**进展更新类型**
```
┌─────────────────────────────────────┐
│ 📅 2024-01-16 10:15                │
│ ├─ 📈 [进展更新] 施工准备工作         │
│ │   👤 王五(物业工程部)              │
│ │   📝 施工队已进场，开始前期准备工作 │
│ │   📷 现场照片 (3张)               │
│ │   📊 进度：10% | 预计完成：2月底   │
│ │   [查看照片] [进度详情]            │
│ │   [👍 28] [👎 0] [👥 12] [➖ 1]     │
└─────────────────────────────────────┘
```

**技术实现：**
- 组件名：`StructuredTimeline`
- 位置：`src/components/StructuredTimeline.tsx`
- 子组件：`TimelineItem`
- 支持不同类型的时间线项目渲染
- 集成轻互动按钮组件（点赞、点踩、从多、弃权）
- 使用图标而非emoji显示互动按钮
- 实时更新互动数据统计

### 7. 业委会操作区 (角色相关)
**新增管理功能**

```
┌─────────────────────────────────────┐
│ 🛠️ 业委会操作                         │
├─────────────────────────────────────┤
│ [📝 新增进展] [🔗 关联流程]            │
└─────────────────────────────────────┘
```

**功能说明：**
- **新增进展**：添加事件的最新进展
- **关联流程**：将现有流程关联到此事件


**权限控制：**
- 只有业委会成员可见此操作区
- 不同操作可能需要不同权限级别
- 普通业主不显示此区域

## 📐 布局规范

### 间距规范
- **组件间距**：16px
- **卡片内边距**：16px
- **时间线项目间距**：12px
- **按钮间距**：8px

### 颜色规范
- **AI卡片背景**：渐变蓝色 (#e6f7ff → #bae7ff)
- **时间线连接线**：浅灰 (#d9d9d9)
- **不同类型图标颜色**：
  - 公告：橙色 (#fa8c16)
  - 征询：蓝色 (#1890ff)
  - 审批：绿色 (#52c41a)
  - 进展：紫色 (#722ed1)

### 字体规范
- **AI卡片标题**：16px，粗体
- **时间线时间**：12px，中灰
- **时间线标题**：14px，粗体
- **时间线内容**：14px，常规
- **统计数据**：12px，常规

## 🔄 交互设计

### AI速览卡片交互
1. **展开/收起动画**：平滑的高度变化
2. **重新分析**：显示加载状态
3. **编辑模式**：内联编辑功能
4. **导出功能**：生成PDF报告

### 时间线交互
1. **筛选切换**：平滑的内容切换
2. **项目展开**：点击查看详细内容
3. **附件预览**：支持图片、文档预览
4. **快速操作**：投票、评论等快速入口

### 操作按钮交互
1. **订阅状态**：实时切换订阅状态
2. **分享功能**：调用原生分享API
3. **点赞动画**：数字跳动效果
4. **更多菜单**：底部弹出菜单

## 📱 响应式设计

### 移动端优化
- AI卡片默认收起状态
- 时间线项目垂直布局
- 操作按钮适配触摸
- 横向滚动的标签筛选

### 平板端优化
- AI卡片可显示更多信息
- 时间线支持更丰富的布局
- 侧边栏显示相关信息

### 桌面端优化
- 固定AI卡片在侧边
- 时间线和详情并排显示
- 鼠标悬停效果
- 键盘快捷键支持

## 🎨 视觉效果

### 动画效果
- **页面进入**：从右侧滑入
- **AI卡片展开**：平滑的高度动画
- **时间线加载**：依次淡入
- **操作反馈**：按钮点击动画

### 状态指示
- **加载状态**：骨架屏和加载指示器
- **空状态**：友好的空状态提示
- **错误状态**：错误信息和重试按钮
- **成功状态**：操作成功的反馈

## 🔧 技术实现要点

### 组件拆分
```
EventDetail.tsx
├── TopNavigation.tsx (复用)
├── AIEventOverview.tsx (新增)
├── EventBasicInfo.tsx (优化)
├── EventActionBar.tsx (优化)
├── TimelineFilter.tsx (新增)
├── StructuredTimeline.tsx (重构)
│   └── TimelineItem.tsx (优化)

```

### 数据结构
```typescript
// AI分析结果
interface AIAnalysis {
  summary: string;
  keyParticipants: {
    committee: string[];
    property: string[];
    residents: string[];
  };
  timeline: {
    date: string;
    event: string;
    status: 'completed' | 'planned';
  }[];
  currentStatus: string;
  impact: string;
  budget?: {
    total: number;
    breakdown: Record<string, number>;
  };
  contract?: {
    contractor: string;
    amount: number;
    warranty: string;
  };
}

// 时间线项目
interface TimelineItem {
  id: string;
  type: 'announcement' | 'poll' | 'approval' | 'progress';
  title: string;
  content: string;
  author: {
    name: string;
    role: string;
  };
  timestamp: string;
  attachments?: Attachment[];
  stats?: {
    views: number;
    comments: number;
    votes?: {
      yes: number;
      no: number;
    };
  };
}
```

### 性能优化
- **虚拟滚动**：长时间线的性能优化
- **图片懒加载**：附件图片延迟加载
- **数据缓存**：AI分析结果缓存
- **增量更新**：时间线增量加载

---

*此设计文档将在开发过程中持续更新和完善*